{% extends 'layout.html' %}

{% block title %} {{title}} {% endblock title %}

{% block head %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<style>
#columnchart_material{
  position: absolute;
  left: 50%;
  top: 55%;
  transform: translate(-50%, -50%);
  /* border: 5px solid #FFFF00; */
  padding: 10px;
}

</style>
{% endblock head %}

{% block body %}

<!-- Start Welcome User -->
<div class="container" id="hstDiv" data-userHist='{{ userHist }}'>

  <div id="columnchart_material" style="width: 800px; height: 500px;"></div>

</div>
  
<script type="text/javascript">

  var userHist = document.getElementById("hstDiv").getAttribute('data-userHist');
  console.log(userHist);
  userHist = "{ 'data': " + userHist + "}";
  userHist = userHist.replace(/\'/g, '"');
  userHist = JSON.parse(userHist);
  hstArray = userHist.data;
  console.log(hstArray);


  google.charts.load('current', {'packages':['bar']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    // Labels
    xTitle = "Session Date";
    firstBarTitle = "Total Minutes Studied";
    secondBarTitle = "Total Key Presses";
    thirdBarTitle = "Total Mouse Clicks";
    labels = [xTitle, firstBarTitle, secondBarTitle, thirdBarTitle];

    // Data
    sessions = [labels];
    hstArray.forEach(elm => {
      sessions.push([elm.date, elm.clickCount, elm.keyCount, elm.timeStudied]);
    });
    
    var data = google.visualization.arrayToDataTable(sessions);

    var options = {
      chart: {
        title: 'Session History',
        subtitle: 'Totals for each previous session',
      }
    };

    var chart = new google.charts.Bar(document.getElementById('columnchart_material'));

    chart.draw(data, google.charts.Bar.convertOptions(options));
  }
</script>



{% endblock body %}


